import{d as q,g as z,r as n,b as A,o as w,l as U,w as m,f as o,a,m as V,p as M,i as j,M as R,x as B,A as E,z as G,D as H,__tla as J}from"./index-456ccb5c.js";import{_ as K,__tla as L}from"./Dialog.vue_vue_type_style_index_0_lang-c9eb9937.js";import{_ as N,__tla as O}from"./UploadImgs-f366bb9f.js";import{a as Q,c as T,b as W,__tla as X}from"./page-6040e12c.js";import{u as Y,__tla as Z}from"./useMessage-59021f66.js";let I,$=Promise.all([(()=>{try{return J}catch{}})(),(()=>{try{return L}catch{}})(),(()=>{try{return O}catch{}})(),(()=>{try{return X}catch{}})(),(()=>{try{return Z}catch{}})()]).then(async()=>{I=q({name:"DiyPageForm",__name:"DiyPageForm",emits:["success"],setup(ee,{expose:b,emit:h}){const{t:_}=z(),v=Y(),i=n(!1),f=n(""),d=n(!1),y=n(""),l=n({id:void 0,name:void 0,remark:void 0,previewImageUrls:[]}),k=A({name:[{required:!0,message:"\u9875\u9762\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),c=n();b({open:async(s,e)=>{var t;if(i.value=!0,f.value=_("action."+s),y.value=s,F(),e){d.value=!0;try{const r=await Q(e);((t=r==null?void 0:r.previewImageUrls)==null?void 0:t.length)>0&&(r.previewImageUrls=r.previewImageUrls.map(p=>({url:p}))),l.value=r}finally{d.value=!1}}}});const x=h,D=async()=>{if(c&&await c.value.validate()){d.value=!0;try{const s=l.value.previewImageUrls.map(t=>t.url?t.url:t),e={...l.value,previewImageUrls:s};y.value==="create"?(await T(e),v.success(_("common.createSuccess"))):(await W(e),v.success(_("common.updateSuccess"))),i.value=!1,x("success")}finally{d.value=!1}}},F=()=>{var s;l.value={id:void 0,name:void 0,remark:void 0,previewImageUrls:[]},(s=c.value)==null||s.resetFields()};return(s,e)=>{const t=R,r=B,p=N,P=E,g=G,C=K,S=H;return w(),U(C,{title:a(f),modelValue:a(i),"onUpdate:modelValue":e[4]||(e[4]=u=>j(i)?i.value=u:null)},{footer:m(()=>[o(g,{onClick:D,type:"primary",disabled:a(d)},{default:m(()=>[V("\u786E \u5B9A")]),_:1},8,["disabled"]),o(g,{onClick:e[3]||(e[3]=u=>i.value=!1)},{default:m(()=>[V("\u53D6 \u6D88")]),_:1})]),default:m(()=>[M((w(),U(P,{ref_key:"formRef",ref:c,model:a(l),rules:a(k),"label-width":"100px"},{default:m(()=>[o(r,{label:"\u9875\u9762\u540D\u79F0",prop:"name"},{default:m(()=>[o(t,{modelValue:a(l).name,"onUpdate:modelValue":e[0]||(e[0]=u=>a(l).name=u),placeholder:"\u8BF7\u8F93\u5165\u9875\u9762\u540D\u79F0"},null,8,["modelValue"])]),_:1}),o(r,{label:"\u5907\u6CE8",prop:"remark"},{default:m(()=>[o(t,{modelValue:a(l).remark,"onUpdate:modelValue":e[1]||(e[1]=u=>a(l).remark=u),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8"},null,8,["modelValue"])]),_:1}),o(r,{label:"\u9884\u89C8\u56FE",prop:"previewImageUrls"},{default:m(()=>[o(p,{modelValue:a(l).previewImageUrls,"onUpdate:modelValue":e[2]||(e[2]=u=>a(l).previewImageUrls=u)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[S,a(d)]])]),_:1},8,["title","modelValue"])}}})});export{I as _,$ as __tla};
