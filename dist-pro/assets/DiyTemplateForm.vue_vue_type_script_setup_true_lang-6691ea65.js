import{d as S,l as j,r as n,f as B,o as U,q as g,w as m,i as o,a,j as V,B as L,x as H,T as M,D as P,I as R,H as z,L as A,__tla as E}from"./index-0d81347e.js";import{_ as G,__tla as J}from"./Dialog.vue_vue_type_style_index_0_lang-9d93c798.js";import{_ as K,__tla as N}from"./UploadImgs-9ed1274f.js";import{a as O,c as Q,b as W,__tla as X}from"./template-525e93a8.js";import{u as Y,__tla as Z}from"./useMessage-da459548.js";let I,$=Promise.all([(()=>{try{return E}catch{}})(),(()=>{try{return J}catch{}})(),(()=>{try{return N}catch{}})(),(()=>{try{return X}catch{}})(),(()=>{try{return Z}catch{}})()]).then(async()=>{I=S({name:"DiyTemplateForm",__name:"DiyTemplateForm",emits:["success"],setup(ee,{expose:h,emit:b}){const{t:p}=j(),v=Y(),i=n(!1),f=n(""),d=n(!1),y=n(""),l=n({id:void 0,name:void 0,remark:void 0,previewImageUrls:[]}),k=B({name:[{required:!0,message:"\u6A21\u677F\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),c=n();h({open:async(s,e)=>{var t;if(i.value=!0,f.value=p("action."+s),y.value=s,F(),e){d.value=!0;try{const r=await O(e);((t=r==null?void 0:r.previewImageUrls)==null?void 0:t.length)>0&&(r.previewImageUrls=r.previewImageUrls.map(_=>({url:_}))),l.value=r}finally{d.value=!1}}}});const x=b,D=async()=>{if(c&&await c.value.validate()){d.value=!0;try{const s=l.value.previewImageUrls.map(t=>t.url?t.url:t),e={...l.value,previewImageUrls:s};y.value==="create"?(await Q(e),v.success(p("common.createSuccess"))):(await W(e),v.success(p("common.updateSuccess"))),i.value=!1,x("success")}finally{d.value=!1}}},F=()=>{var s;l.value={id:void 0,name:void 0,remark:void 0,previewImageUrls:[]},(s=c.value)==null||s.resetFields()};return(s,e)=>{const t=M,r=P,_=K,T=R,w=z,q=G,C=A;return U(),g(q,{title:a(f),modelValue:a(i),"onUpdate:modelValue":e[4]||(e[4]=u=>H(i)?i.value=u:null)},{footer:m(()=>[o(w,{onClick:D,type:"primary",disabled:a(d)},{default:m(()=>[V("\u786E \u5B9A")]),_:1},8,["disabled"]),o(w,{onClick:e[3]||(e[3]=u=>i.value=!1)},{default:m(()=>[V("\u53D6 \u6D88")]),_:1})]),default:m(()=>[L((U(),g(T,{ref_key:"formRef",ref:c,model:a(l),rules:a(k),"label-width":"100px"},{default:m(()=>[o(r,{label:"\u6A21\u677F\u540D\u79F0",prop:"name"},{default:m(()=>[o(t,{modelValue:a(l).name,"onUpdate:modelValue":e[0]||(e[0]=u=>a(l).name=u),placeholder:"\u8BF7\u8F93\u5165\u6A21\u677F\u540D\u79F0"},null,8,["modelValue"])]),_:1}),o(r,{label:"\u5907\u6CE8",prop:"remark"},{default:m(()=>[o(t,{modelValue:a(l).remark,"onUpdate:modelValue":e[1]||(e[1]=u=>a(l).remark=u),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8",type:"textarea"},null,8,["modelValue"])]),_:1}),o(r,{label:"\u9884\u89C8\u56FE",prop:"previewImageUrls"},{default:m(()=>[o(_,{modelValue:a(l).previewImageUrls,"onUpdate:modelValue":e[2]||(e[2]=u=>a(l).previewImageUrls=u)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[C,a(d)]])]),_:1},8,["title","modelValue"])}}})});export{I as _,$ as __tla};
