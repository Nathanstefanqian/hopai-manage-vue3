import{d as q,g as z,r as n,b as A,o as g,l as U,w as u,f as o,a,m as V,p as M,i as j,M as P,x as R,A as B,z as E,D as G,__tla as H}from"./index-c0a26e5e.js";import{_ as J,__tla as K}from"./Dialog.vue_vue_type_style_index_0_lang-a2d2167b.js";import{_ as L,__tla as N}from"./UploadImgs-42305c92.js";import{a as O,c as Q,b as W,__tla as X}from"./template-4066e9ac.js";import{u as Y,__tla as Z}from"./useMessage-3978ad3b.js";let I,$=Promise.all([(()=>{try{return H}catch{}})(),(()=>{try{return K}catch{}})(),(()=>{try{return N}catch{}})(),(()=>{try{return X}catch{}})(),(()=>{try{return Z}catch{}})()]).then(async()=>{I=q({name:"DiyTemplateForm",__name:"DiyTemplateForm",emits:["success"],setup(ee,{expose:b,emit:h}){const{t:c}=z(),v=Y(),i=n(!1),f=n(""),d=n(!1),y=n(""),l=n({id:void 0,name:void 0,remark:void 0,previewImageUrls:[]}),k=A({name:[{required:!0,message:"\u6A21\u677F\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),p=n();b({open:async(s,e)=>{var t;if(i.value=!0,f.value=c("action."+s),y.value=s,F(),e){d.value=!0;try{const r=await O(e);((t=r==null?void 0:r.previewImageUrls)==null?void 0:t.length)>0&&(r.previewImageUrls=r.previewImageUrls.map(_=>({url:_}))),l.value=r}finally{d.value=!1}}}});const x=h,D=async()=>{if(p&&await p.value.validate()){d.value=!0;try{const s=l.value.previewImageUrls.map(t=>t.url?t.url:t),e={...l.value,previewImageUrls:s};y.value==="create"?(await Q(e),v.success(c("common.createSuccess"))):(await W(e),v.success(c("common.updateSuccess"))),i.value=!1,x("success")}finally{d.value=!1}}},F=()=>{var s;l.value={id:void 0,name:void 0,remark:void 0,previewImageUrls:[]},(s=p.value)==null||s.resetFields()};return(s,e)=>{const t=P,r=R,_=L,C=B,w=E,S=J,T=G;return g(),U(S,{title:a(f),modelValue:a(i),"onUpdate:modelValue":e[4]||(e[4]=m=>j(i)?i.value=m:null)},{footer:u(()=>[o(w,{onClick:D,type:"primary",disabled:a(d)},{default:u(()=>[V("\u786E \u5B9A")]),_:1},8,["disabled"]),o(w,{onClick:e[3]||(e[3]=m=>i.value=!1)},{default:u(()=>[V("\u53D6 \u6D88")]),_:1})]),default:u(()=>[M((g(),U(C,{ref_key:"formRef",ref:p,model:a(l),rules:a(k),"label-width":"100px"},{default:u(()=>[o(r,{label:"\u6A21\u677F\u540D\u79F0",prop:"name"},{default:u(()=>[o(t,{modelValue:a(l).name,"onUpdate:modelValue":e[0]||(e[0]=m=>a(l).name=m),placeholder:"\u8BF7\u8F93\u5165\u6A21\u677F\u540D\u79F0"},null,8,["modelValue"])]),_:1}),o(r,{label:"\u5907\u6CE8",prop:"remark"},{default:u(()=>[o(t,{modelValue:a(l).remark,"onUpdate:modelValue":e[1]||(e[1]=m=>a(l).remark=m),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8",type:"textarea"},null,8,["modelValue"])]),_:1}),o(r,{label:"\u9884\u89C8\u56FE",prop:"previewImageUrls"},{default:u(()=>[o(_,{modelValue:a(l).previewImageUrls,"onUpdate:modelValue":e[2]||(e[2]=m=>a(l).previewImageUrls=m)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[T,a(d)]])]),_:1},8,["title","modelValue"])}}})});export{I as _,$ as __tla};
