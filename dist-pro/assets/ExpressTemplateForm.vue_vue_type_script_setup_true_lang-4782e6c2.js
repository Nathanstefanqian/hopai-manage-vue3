import{al as v,d as W,g as Y,r as i,b as Z,j as ee,o as y,l as U,w as l,f as a,a as r,m,p as ae,c as le,F as te,k as re,t as oe,i as se,aq as k,ao as ue,dX as T,M as de,x as ne,ab as ie,ac as ce,bB as pe,B as me,bA as fe,z as _e,C as ge,_ as Ve,A as he,D as be,__tla as ve}from"./index-e69fb82c.js";import{_ as Ce,__tla as xe}from"./Dialog.vue_vue_type_style_index_0_lang-dccb0a2a.js";import{a as ye,D as we,__tla as Pe}from"./dict-9c294b1e.js";import{g as Ue,__tla as ke}from"./index-3750345f.js";import{d as Te}from"./tree-ebab458e.js";import{u as Me,__tla as Ee}from"./useMessage-ac7e9ad3.js";let S,$,B,Ie=Promise.all([(()=>{try{return ve}catch{}})(),(()=>{try{return xe}catch{}})(),(()=>{try{return Pe}catch{}})(),(()=>{try{return ke}catch{}})(),(()=>{try{return Ee}catch{}})()]).then(async()=>{B=async C=>await v.get({url:"/trade/delivery/express-template/page",params:C}),$=async C=>await v.delete({url:"/trade/delivery/express-template/delete?id="+C}),S=W({__name:"ExpressTemplateForm",emits:["success"],setup(C,{expose:D,emit:X}){const{t:w}=Y(),M=Me(),E={...Te,multiple:!0},f=i(!1),I=i(""),_=i(!1),q=i(""),o=i({id:void 0,name:"",chargeMode:1,sort:0,charges:[],frees:[]}),g=new Map,V=i({startCountTitle:"\u9996\u4EF6",extraCountTitle:"\u7EED\u4EF6",freeCountTitle:"\u5305\u90AE\u4EF6\u6570"}),j=Z({name:[{required:!0,message:"\u6A21\u677F\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],chargeMode:[{required:!0,message:"\u914D\u9001\u8BA1\u8D39\u65B9\u5F0F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],sort:[{required:!0,message:"\u5206\u7C7B\u6392\u5E8F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),x=i();D({open:async(u,t)=>{f.value=!0,I.value=w("action."+u),q.value=u,H();try{t&&(_.value=!0,o.value=await(async d=>await v.get({url:"/trade/delivery/express-template/get?id="+d}))(t),V.value=g.get(o.value.chargeMode),o.value.charges.forEach(d=>{d.startPrice=k(d.startPrice),d.extraPrice=k(d.extraPrice)}),o.value.frees.forEach(d=>{d.freePrice=k(d.freePrice)}))}finally{_.value=!1}}});const z=X,G=async()=>{if(x&&await x.value.validate()){_.value=!0;try{const u=ue(o.value);u.charges.forEach(t=>{t.startPrice=T(t.startPrice),t.extraPrice=T(t.extraPrice)}),u.frees.forEach(t=>{t.freePrice=T(t.freePrice)}),q.value==="create"?(await(async t=>await v.post({url:"/trade/delivery/express-template/create",data:t}))(u),M.success(w("common.createSuccess"))):(await(async t=>await v.put({url:"/trade/delivery/express-template/update",data:t}))(u),M.success(w("common.updateSuccess"))),f.value=!1,z("success")}finally{_.value=!1}}},H=()=>{var u;o.value={id:void 0,name:"",chargeMode:1,charges:[{areaIds:[1],startCount:2,startPrice:5,extraCount:5,extraPrice:10}],frees:[],sort:0},V.value=g.get(1),(u=x.value)==null||u.resetFields()},O=u=>{V.value=g.get(u)},P=i([]);return ee(()=>{(async()=>(g.set(1,{startCountTitle:"\u9996\u4EF6",extraCountTitle:"\u7EED\u4EF6",freeCountTitle:"\u5305\u90AE\u4EF6\u6570"}),g.set(2,{startCountTitle:"\u9996\u4EF6\u91CD\u91CF(kg)",extraCountTitle:"\u7EED\u4EF6\u91CD\u91CF(kg)",freeCountTitle:"\u5305\u90AE\u91CD\u91CF(kg)"}),g.set(3,{startCountTitle:"\u9996\u4EF6\u4F53\u79EF(m\xB3)",extraCountTitle:"\u7EED\u4EF6\u4F53\u79EF(m\xB3)",freeCountTitle:"\u5305\u90AE\u4F53\u79EF(m\xB3)"}),P.value=await Ue()))()}),(u,t)=>{const d=de,c=ne,J=ie,K=ce,A=pe,n=me,p=fe,h=_e,F=ge,R=Ve,L=he,N=Ce,Q=be;return y(),U(N,{title:r(I),modelValue:r(f),"onUpdate:modelValue":t[6]||(t[6]=e=>se(f)?f.value=e:null),width:"1300px"},{footer:l(()=>[a(h,{onClick:G,type:"primary",disabled:r(_)},{default:l(()=>[m("\u786E \u5B9A")]),_:1},8,["disabled"]),a(h,{onClick:t[5]||(t[5]=e=>f.value=!1)},{default:l(()=>[m("\u53D6 \u6D88")]),_:1})]),default:l(()=>[ae((y(),U(L,{ref_key:"formRef",ref:x,model:r(o),rules:r(j),"label-width":"80px"},{default:l(()=>[a(c,{label:"\u6A21\u677F\u540D\u79F0",prop:"name"},{default:l(()=>[a(d,{modelValue:r(o).name,"onUpdate:modelValue":t[0]||(t[0]=e=>r(o).name=e),placeholder:"\u8BF7\u8F93\u5165\u6A21\u677F\u540D\u79F0"},null,8,["modelValue"])]),_:1}),a(c,{label:"\u8BA1\u8D39\u65B9\u5F0F",prop:"chargeMode"},{default:l(()=>[a(K,{modelValue:r(o).chargeMode,"onUpdate:modelValue":t[1]||(t[1]=e=>r(o).chargeMode=e),onChange:O},{default:l(()=>[(y(!0),le(te,null,re(r(ye)(r(we).EXPRESS_CHARGE_MODE),e=>(y(),U(J,{key:e.value,label:e.value},{default:l(()=>[m(oe(e.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(c,{label:"\u8FD0\u8D39",prop:"charges"},{default:l(()=>[a(F,{border:"",style:{width:"100%"},data:r(o).charges},{default:l(()=>[a(n,{align:"center",label:"\u533A\u57DF",width:"360"},{default:l(({row:e})=>[a(A,{modelValue:e.areaIds,"onUpdate:modelValue":s=>e.areaIds=s,options:r(P),props:E,class:"w-1/1",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u5730\u533A",filterable:"","collapse-tags":""},null,8,["modelValue","onUpdate:modelValue","options"])]),_:1}),a(n,{align:"center",label:r(V).startCountTitle,width:"180",prop:"startCount"},{default:l(({row:e})=>[a(p,{modelValue:e.startCount,"onUpdate:modelValue":s=>e.startCount=s,min:1},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),a(n,{width:"180",align:"center",label:"\u8FD0\u8D39(\u5143)",prop:"startPrice"},{default:l(({row:e})=>[a(p,{modelValue:e.startPrice,"onUpdate:modelValue":s=>e.startPrice=s,min:1},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(n,{width:"180",align:"center",label:r(V).extraCountTitle,prop:"extraCount"},{default:l(({row:e})=>[a(p,{modelValue:e.extraCount,"onUpdate:modelValue":s=>e.extraCount=s,min:1},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),a(n,{width:"180",align:"center",label:"\u7EED\u8D39(\u5143)",prop:"extraPrice"},{default:l(({row:e})=>[a(p,{modelValue:e.extraPrice,"onUpdate:modelValue":s=>e.extraPrice=s,min:1},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(n,{label:"\u64CD\u4F5C",align:"center"},{default:l(e=>[a(h,{link:"",type:"danger",onClick:s=>{return b=e.$index,void o.value.charges.splice(b,1);var b}},{default:l(()=>[m(" \u5220\u9664 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),a(c,null,{default:l(()=>[a(h,{type:"primary",plain:"",onClick:t[2]||(t[2]=e=>{o.value.charges.push({areaIds:[],startCount:1,startPrice:1,extraCount:1,extraPrice:1})})},{default:l(()=>[a(R,{icon:"ep:plus",class:"mr-5px"}),m(" \u6DFB\u52A0\u533A\u57DF ")]),_:1})]),_:1}),a(c,{label:"\u5305\u90AE\u533A\u57DF",prop:"frees"},{default:l(()=>[a(F,{border:"",style:{width:"100%"},data:r(o).frees},{default:l(()=>[a(n,{align:"center",label:"\u533A\u57DF",width:"360"},{default:l(({row:e})=>[a(A,{modelValue:e.areaIds,"onUpdate:modelValue":s=>e.areaIds=s,options:r(P),props:E,class:"w-1/1",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u5546\u54C1\u5206\u7C7B",filterable:"","collapse-tags":""},null,8,["modelValue","onUpdate:modelValue","options"])]),_:1}),a(n,{align:"center",label:r(V).freeCountTitle,prop:"freeCount"},{default:l(({row:e})=>[a(p,{modelValue:e.freeCount,"onUpdate:modelValue":s=>e.freeCount=s,min:1},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),a(n,{align:"center",label:"\u5305\u90AE\u91D1\u989D\uFF08\u5143\uFF09",prop:"freePrice"},{default:l(({row:e})=>[a(p,{modelValue:e.freePrice,"onUpdate:modelValue":s=>e.freePrice=s,min:1},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(n,{label:"\u64CD\u4F5C",align:"center"},{default:l(e=>[a(h,{link:"",type:"danger",onClick:s=>{return b=e.$index,void o.value.frees.splice(b,1);var b}},{default:l(()=>[m(" \u5220\u9664 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),a(c,null,{default:l(()=>[a(h,{type:"primary",plain:"",onClick:t[3]||(t[3]=e=>{o.value.frees.push({areaIds:[],freeCount:1,freePrice:1})})},{default:l(()=>[a(R,{icon:"ep:plus",class:"mr-5px"}),m(" \u6DFB\u52A0\u533A\u57DF ")]),_:1})]),_:1}),a(c,{label:"\u6392\u5E8F",prop:"sort"},{default:l(()=>[a(p,{modelValue:r(o).sort,"onUpdate:modelValue":t[4]||(t[4]=e=>r(o).sort=e),"controls-position":"right",min:0},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[Q,r(_)]])]),_:1},8,["title","modelValue"])}}})});export{S as _,Ie as __tla,$ as d,B as g};
