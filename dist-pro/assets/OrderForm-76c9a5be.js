import{d as Z,r as s,G as $,b as ee,j as ae,o,l as z,w as r,f as u,m as p,a as l,c as b,p as le,e as V,F as E,k as G,t as J,i as L,V as re,bO as te,x as se,af as ue,cb as oe,z as de,a4 as _e,by as ne,A as ce,D as ie,__tla as me}from"./index-c0a26e5e.js";import{_ as fe,__tla as ve}from"./Dialog.vue_vue_type_style_index_0_lang-a2d2167b.js";import{E as pe,__tla as ye}from"./el-tree-select-c8986098.js";import{e as Ie,f as ge,__tla as he}from"./index-de6b767a.js";import{g as be,__tla as Ve}from"./index-a1da61b2.js";import{a as ke,__tla as xe}from"./spu-23512eac.js";import{_ as we,__tla as Ce}from"./MemberTagSelect.vue_vue_type_script_setup_true_lang-b7cc6a78.js";import{d as Ue}from"./tree-ebab458e.js";import{u as qe,__tla as ze}from"./useMessage-3978ad3b.js";import{_ as Fe}from"./_plugin-vue_export-helper-1b428a4d.js";import{__tla as Oe}from"./index-c5e680a0.js";import{__tla as je}from"./TagForm.vue_vue_type_script_setup_true_lang-ea535f80.js";import{__tla as Ne}from"./index-5adaa6bb.js";let P,Se=Promise.all([(()=>{try{return me}catch{}})(),(()=>{try{return ve}catch{}})(),(()=>{try{return ye}catch{}})(),(()=>{try{return he}catch{}})(),(()=>{try{return Ve}catch{}})(),(()=>{try{return xe}catch{}})(),(()=>{try{return Ce}catch{}})(),(()=>{try{return ze}catch{}})(),(()=>{try{return Oe}catch{}})(),(()=>{try{return je}catch{}})(),(()=>{try{return Ne}catch{}})()]).then(async()=>{let F,O,j;F={key:0},O={class:"scrollbar-flex-content"},j={class:"flex"},P=Fe(Z({__name:"OrderForm",props:{userInfo:{}},emits:["success"],setup(R,{expose:T,emit:B}){const H=B,N=s(""),d=s(!1),K=R,k=s(),x=s([]),S=s([]),_=s(""),w=qe(),C=s(!1),A=$().params.id,m=s({...K.userInfo}),U=s([...m.value.areaNames]),t=s({areaIds:[...m.value.areaIds],levelId:m.value.levelId,categoryIds:m.value.categoryIds}),M=ee({levelId:[{required:!0,message:"\u6444\u5F71\u5E08\u7B49\u7EA7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],categoryIds:[{required:!0,message:"\u670D\u52A1\u8303\u56F4\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],areaIds:[{required:!0,message:"\u670D\u52A1\u533A\u57DF\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),Q=()=>{const f=(e=>{const n=(q,I,v)=>{for(const c of q){const g=[...v,c.name];if(c.id===I)return g;if(c.children){const h=n(c.children,I,g);if(h)return h}}return null},y=n(x.value,e,[]);return y?y.join("-"):null})(_.value);if(f){if(t.value.areaIds.findIndex(e=>e===_.value)>-1)return void w.error("\u8BE5\u5730\u533A\u5DF2\u5B58\u5728");t.value.areaIds.unshift(_.value),U.value.unshift(f)}else w.error("\u8BF7\u5148\u9009\u62E9\u5730\u533A")},W=()=>{t.value={areaIds:[],levelId:"",bizIds:[]}};return T({open:async()=>{d.value=!0,N.value="\u63A5\u5355\u4FE1\u606F"}}),ae(async()=>{x.value=await be();const f=await ke({pageNo:1,pageSize:50});S.value=f.list.map(e=>({categoryId:e.categoryId,name:e.name}))}),(f,e)=>{const n=se,y=ue,q=oe,I=pe,v=de,c=_e,g=ne,h=ce,X=fe,Y=ie;return o(),z(X,{title:l(N),modelValue:l(d),"onUpdate:modelValue":e[6]||(e[6]=a=>L(d)?d.value=a:null)},{footer:r(()=>[u(v,{type:"primary",onClick:e[4]||(e[4]=a=>(async()=>{if(k&&await k.value.validate()){C.value=!0;try{const i=s(t.value);await Ie({...i.value,userId:A}),await ge({levelId:t.value.levelId,id:A}),w.success("\u4FEE\u6539\u6210\u529F"),H("success"),d.value=!1}finally{C.value=!1}}})())},{default:r(()=>[p("\u786E\u5B9A")]),_:1}),u(v,{onClick:e[5]||(e[5]=a=>(W(),void(d.value=!1)))},{default:r(()=>[p("\u53D6\u6D88")]),_:1})]),default:r(()=>[l(m)?(o(),b("div",F,[le((o(),z(h,{ref_key:"orderRef",ref:k,"label-width":"100px",model:l(t),rules:l(M)},{default:r(()=>[u(n,{label:"\u6444\u5F71\u5E08\u7B49\u7EA7",prop:"levelId"},{default:r(()=>[u(we,{modelValue:l(t).levelId,"onUpdate:modelValue":e[0]||(e[0]=a=>l(t).levelId=a),multiple:!1},null,8,["modelValue"])]),_:1}),u(n,{label:"\u670D\u52A1\u533A\u57DF",prop:"areaIds"},{default:r(()=>[V("div",null,[u(q,null,{default:r(()=>[V("div",O,[(o(!0),b(E,null,G(l(U),(a,i)=>(o(),b("div",{class:"scrollbar-demo-item",key:i},[u(y,{color:"#fff",onClick:Ae=>(D=>{te.confirm("\u786E\u8BA4\u5220\u9664\u5417","\u8B66\u544A").then(async()=>{U.value.splice(D,1),t.value.areaIds.splice(D,1)})})(i)},{default:r(()=>[p(J(a),1)]),_:2},1032,["onClick"])]))),128))])]),_:1}),V("div",j,[u(I,{modelValue:l(_),"onUpdate:modelValue":e[1]||(e[1]=a=>L(_)?_.value=a:null),data:l(x),props:l(Ue),"render-after-expand":!0},null,8,["modelValue","data","props"]),u(v,{text:"",type:"primary",onClick:e[2]||(e[2]=a=>Q())},{default:r(()=>[p("\u6DFB\u52A0")]),_:1})])])]),_:1}),u(n,{label:"\u670D\u52A1\u8303\u56F4",prop:"categoryIds"},{default:r(()=>[V("div",null,[u(g,{modelValue:l(t).categoryIds,"onUpdate:modelValue":e[3]||(e[3]=a=>l(t).categoryIds=a)},{default:r(()=>[(o(!0),b(E,null,G(l(S),(a,i)=>(o(),z(c,{key:i,value:a.categoryId,label:a.categoryId},{default:r(()=>[p(J(a.name),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])])]),_:1})]),_:1},8,["model","rules"])),[[Y,l(C)]])])):re("",!0)]),_:1},8,["title","modelValue"])}}}),[["__scopeId","data-v-19665501"]])});export{Se as __tla,P as default};
