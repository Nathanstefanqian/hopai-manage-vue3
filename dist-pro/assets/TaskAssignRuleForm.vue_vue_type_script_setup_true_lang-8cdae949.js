import{_ as J,__tla as O}from"./Dialog.vue_vue_type_style_index_0_lang-9d93c798.js";import{ao as h,d as Q,r as p,f as W,o as r,q as d,w as u,i as o,j as x,a as l,c as y,k as I,F as v,a1 as f,x as X,l as Z,T as $,D as ee,C as ae,I as le,H as te,M as se,__tla as ue}from"./index-0d81347e.js";import{E as re,__tla as oe}from"./el-tree-select-f0321f9b.js";import{a as A,D as R,__tla as de}from"./dict-d9e0d1ac.js";import{d as pe,h as ie}from"./tree-ebab458e.js";import{g as ne,__tla as me}from"./index-142cb997.js";import{g as _e,__tla as ce}from"./index-33514c43.js";import{g as ye,__tla as Ie}from"./index-f5021075.js";import{g as ve,__tla as fe}from"./index-e3f7e17a.js";import{g as ge,__tla as be}from"./index-b884dba4.js";import{u as he,__tla as ke}from"./useMessage-da459548.js";let K,P,Ve=Promise.all([(()=>{try{return O}catch{}})(),(()=>{try{return ue}catch{}})(),(()=>{try{return oe}catch{}})(),(()=>{try{return de}catch{}})(),(()=>{try{return me}catch{}})(),(()=>{try{return ce}catch{}})(),(()=>{try{return Ie}catch{}})(),(()=>{try{return fe}catch{}})(),(()=>{try{return be}catch{}})(),(()=>{try{return ke}catch{}})()]).then(async()=>{P=async k=>await h.get({url:"/bpm/task-assign-rule/list",params:k}),K=Q({name:"BpmTaskAssignRuleForm",__name:"TaskAssignRuleForm",emits:["success"],setup(k,{expose:C,emit:F}){const{t:V}=Z(),w=he(),n=p(!1),b=p(!1),t=p({type:NaN,modelId:"",options:[],roleIds:[],deptIds:[],postIds:[],userIds:[],userGroupIds:[],scripts:[]}),B=W({type:[{required:!0,message:"\u89C4\u5219\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],roleIds:[{required:!0,message:"\u6307\u5B9A\u89D2\u8272\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],deptIds:[{required:!0,message:"\u6307\u5B9A\u90E8\u95E8\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],postIds:[{required:!0,message:"\u6307\u5B9A\u5C97\u4F4D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],userIds:[{required:!0,message:"\u6307\u5B9A\u7528\u6237\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],userGroupIds:[{required:!0,message:"\u6307\u5B9A\u7528\u6237\u7EC4\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],scripts:[{required:!0,message:"\u6307\u5B9A\u811A\u672C\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}]}),g=p(),G=p([]),U=p([]),D=p(),S=p([]),q=p([]),N=p([]),E=A(R.BPM_TASK_ASSIGN_SCRIPT);C({open:async(s,a)=>{H(),t.value={...a,modelId:s,options:[],roleIds:[],deptIds:[],postIds:[],userIds:[],userGroupIds:[],scripts:[]},a.type===10?t.value.roleIds.push(...a.options):a.type===20||a.type===21?t.value.deptIds.push(...a.options):a.type===22?t.value.postIds.push(...a.options):a.type===30||a.type===31||a.type===32?t.value.userIds.push(...a.options):a.type===40?t.value.userGroupIds.push(...a.options):a.type===50&&t.value.scripts.push(...a.options),n.value=!0,G.value=await ne(),U.value=await _e(),D.value=ie(U.value,"id"),S.value=await ye(),q.value=await ve(),N.value=await ge()}});const M=F,j=async()=>{if(!g||!await g.value.validate())return;const s={...t.value,taskDefinitionName:void 0};s.type===10?s.options=s.roleIds:s.type===20||s.type===21?s.options=s.deptIds:s.type===22?s.options=s.postIds:s.type===30||s.type===31||s.type===32?s.options=s.userIds:s.type===40?s.options=s.userGroupIds:s.type===50&&(s.options=s.scripts),s.roleIds=void 0,s.deptIds=void 0,s.postIds=void 0,s.userIds=void 0,s.userGroupIds=void 0,s.scripts=void 0,b.value=!0;try{const a=s;a.id?(await(async m=>await h.put({url:"/bpm/task-assign-rule/update",data:m}))(a),w.success(V("common.updateSuccess"))):(await(async m=>await h.post({url:"/bpm/task-assign-rule/create",data:m}))(a),w.success(V("common.createSuccess"))),n.value=!1,M("success")}finally{b.value=!1}},H=()=>{var s;(s=g.value)==null||s.resetFields()};return(s,a)=>{const m=$,i=ee,_=se,c=ae,L=re,Y=le,T=te,z=J;return r(),d(z,{modelValue:l(n),"onUpdate:modelValue":a[10]||(a[10]=e=>X(n)?n.value=e:null),title:"\u4FEE\u6539\u4EFB\u52A1\u89C4\u5219",width:"600"},{footer:u(()=>[o(T,{disabled:l(b),type:"primary",onClick:j},{default:u(()=>[x("\u786E \u5B9A")]),_:1},8,["disabled"]),o(T,{onClick:a[9]||(a[9]=e=>n.value=!1)},{default:u(()=>[x("\u53D6 \u6D88")]),_:1})]),default:u(()=>[o(Y,{ref_key:"formRef",ref:g,model:l(t),rules:l(B),"label-width":"80px"},{default:u(()=>[o(i,{label:"\u4EFB\u52A1\u540D\u79F0",prop:"taskDefinitionName"},{default:u(()=>[o(m,{modelValue:l(t).taskDefinitionName,"onUpdate:modelValue":a[0]||(a[0]=e=>l(t).taskDefinitionName=e),disabled:"",placeholder:"\u8BF7\u8F93\u5165\u6D41\u6807\u6807\u8BC6"},null,8,["modelValue"])]),_:1}),o(i,{label:"\u4EFB\u52A1\u6807\u8BC6",prop:"taskDefinitionKey"},{default:u(()=>[o(m,{modelValue:l(t).taskDefinitionKey,"onUpdate:modelValue":a[1]||(a[1]=e=>l(t).taskDefinitionKey=e),disabled:"",placeholder:"\u8BF7\u8F93\u5165\u4EFB\u52A1\u6807\u8BC6"},null,8,["modelValue"])]),_:1}),o(i,{label:"\u89C4\u5219\u7C7B\u578B",prop:"type"},{default:u(()=>[o(c,{modelValue:l(t).type,"onUpdate:modelValue":a[2]||(a[2]=e=>l(t).type=e),clearable:"",style:{width:"100%"}},{default:u(()=>[(r(!0),y(v,null,I(l(A)(l(R).BPM_TASK_ASSIGN_RULE_TYPE),e=>(r(),d(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(t).type===10?(r(),d(i,{key:0,label:"\u6307\u5B9A\u89D2\u8272",prop:"roleIds"},{default:u(()=>[o(c,{modelValue:l(t).roleIds,"onUpdate:modelValue":a[3]||(a[3]=e=>l(t).roleIds=e),clearable:"",multiple:"",style:{width:"100%"}},{default:u(()=>[(r(!0),y(v,null,I(l(G),e=>(r(),d(_,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):f("",!0),l(t).type===20||l(t).type===21?(r(),d(i,{key:1,label:"\u6307\u5B9A\u90E8\u95E8",prop:"deptIds",span:"24"},{default:u(()=>[o(L,{ref:"treeRef",modelValue:l(t).deptIds,"onUpdate:modelValue":a[4]||(a[4]=e=>l(t).deptIds=e),data:l(D),props:l(pe),"empty-text":"\u52A0\u8F7D\u4E2D\uFF0C\u8BF7\u7A0D\u540E",multiple:"","node-key":"id","show-checkbox":""},null,8,["modelValue","data","props"])]),_:1})):f("",!0),l(t).type===22?(r(),d(i,{key:2,label:"\u6307\u5B9A\u5C97\u4F4D",prop:"postIds",span:"24"},{default:u(()=>[o(c,{modelValue:l(t).postIds,"onUpdate:modelValue":a[5]||(a[5]=e=>l(t).postIds=e),clearable:"",multiple:"",style:{width:"100%"}},{default:u(()=>[(r(!0),y(v,null,I(l(S),e=>(r(),d(_,{key:parseInt(e.id),label:e.name,value:parseInt(e.id)},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):f("",!0),l(t).type===30||l(t).type===31||l(t).type===32?(r(),d(i,{key:3,label:"\u6307\u5B9A\u7528\u6237",prop:"userIds",span:"24"},{default:u(()=>[o(c,{modelValue:l(t).userIds,"onUpdate:modelValue":a[6]||(a[6]=e=>l(t).userIds=e),clearable:"",multiple:"",style:{width:"100%"}},{default:u(()=>[(r(!0),y(v,null,I(l(q),e=>(r(),d(_,{key:parseInt(e.id),label:e.nickname,value:parseInt(e.id)},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):f("",!0),l(t).type===40?(r(),d(i,{key:4,label:"\u6307\u5B9A\u7528\u6237\u7EC4",prop:"userGroupIds"},{default:u(()=>[o(c,{modelValue:l(t).userGroupIds,"onUpdate:modelValue":a[7]||(a[7]=e=>l(t).userGroupIds=e),clearable:"",multiple:"",style:{width:"100%"}},{default:u(()=>[(r(!0),y(v,null,I(l(N),e=>(r(),d(_,{key:parseInt(e.id),label:e.name,value:parseInt(e.id)},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):f("",!0),l(t).type===50?(r(),d(i,{key:5,label:"\u6307\u5B9A\u811A\u672C",prop:"scripts"},{default:u(()=>[o(c,{modelValue:l(t).scripts,"onUpdate:modelValue":a[8]||(a[8]=e=>l(t).scripts=e),clearable:"",multiple:"",style:{width:"100%"}},{default:u(()=>[(r(!0),y(v,null,I(l(E),e=>(r(),d(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):f("",!0)]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}})});export{K as _,Ve as __tla,P as g};
