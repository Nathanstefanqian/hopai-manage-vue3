import{d as O,aa as s,c6 as G,r as g,c7 as H,c4 as J,c5 as K,o as i,c as o,f as r,w as L,a as d,n as N,e as c,aE as B,l as P,V as u,aW as Q,F as R,t as h,b6 as X,g as Y,_ as Z,__tla as ee}from"./index-456ccb5c.js";import{E as ae,__tla as te}from"./el-image-viewer-5ea9d668.js";import{u as se,__tla as le}from"./useUpload-cc5bd1be.js";import{u as ie,__tla as oe}from"./useMessage-59021f66.js";import{_ as ne}from"./_plugin-vue_export-helper-1b428a4d.js";let C,de=Promise.all([(()=>{try{return ee}catch{}})(),(()=>{try{return te}catch{}})(),(()=>{try{return le}catch{}})(),(()=>{try{return oe}catch{}})()]).then(async()=>{let y,b,k,v,w,x,T;y={class:"upload-box"},b=["src"],k={key:0},v={key:0},w={key:0},x={key:1,class:"upload-empty"},T={class:"el-upload__tip"},C=ne(O({name:"UploadImg",__name:"UploadImg",props:{modelValue:s.string.def(""),drag:s.bool.def(!0),disabled:s.bool.def(!1),fileSize:s.number.def(30),fileType:s.array.def(["image/jpeg","image/png","image/gif"]),height:s.string.def("150px"),width:s.string.def("150px"),borderradius:s.string.def("8px"),showDelete:s.bool.def(!0),showBtnText:s.bool.def(!0),bucket:s.string.def("product")},emits:["update:modelValue"],setup(e,{emit:E}){G(a=>({"72b394f0":e.width,"6c1fe186":e.height,51702554:e.borderradius}));const p=e,{t:f}=Y(),m=ie(),V=g("id-"+H()),_=g(!1),{signatureUrl:S,getStsToken:$,put:j}=se(),z=E,D=()=>{z("update:modelValue","")},I=g({Authorization:"Bearer "+J(),"tenant-id":K()}),U=()=>{const a=document.querySelector(`#${V.value} .el-upload__input`);a&&a.dispatchEvent(new MouseEvent("click"))},W=async a=>{const{bucket:t}=p;await $(t);const{name:l}=a.file;await j(l,a.file);let n=await S(l);n=n.substring(0,n.indexOf("?")),z("update:modelValue",n),m.success("\u4E0A\u4F20\u6210\u529F")},q=a=>{const t=a.size/1024/1024<p.fileSize,l=p.fileType;return l.includes(a.type)||m.notifyWarning("\u4E0A\u4F20\u56FE\u7247\u4E0D\u7B26\u5408\u6240\u9700\u7684\u683C\u5F0F\uFF01"),t||m.notifyWarning(`\u4E0A\u4F20\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 ${p.fileSize}M\uFF01`),l.includes(a.type)&&t},M=()=>{m.notifyError("\u56FE\u7247\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u60A8\u91CD\u65B0\u4E0A\u4F20\uFF01")};return(a,t)=>{const l=Z,n=Q,A=ae;return i(),o("div",y,[r(n,{id:d(V),"http-request":W,class:N(["upload",e.drag?"no-border":""]),multiple:!1,"show-file-list":!1,headers:d(I),"before-upload":q,"on-error":M,drag:e.drag,accept:e.fileType.join(",")},{default:L(()=>[e.modelValue?(i(),o(R,{key:0},[c("img",{src:e.modelValue,class:"upload-image"},null,8,b),c("div",{class:"upload-handle",onClick:t[1]||(t[1]=X(()=>{},["stop"]))},[c("div",{class:"handle-icon",onClick:U},[r(l,{icon:"ep:edit"}),e.showBtnText?(i(),o("span",k,h(d(f)("action.edit")),1)):u("",!0)]),c("div",{class:"handle-icon",onClick:t[0]||(t[0]=F=>_.value=!0)},[r(l,{icon:"ep:zoom-in"}),e.showBtnText?(i(),o("span",v,h(d(f)("action.detail")),1)):u("",!0)]),e.showDelete?(i(),o("div",{key:0,class:"handle-icon",onClick:D},[r(l,{icon:"ep:delete"}),e.showBtnText?(i(),o("span",w,h(d(f)("action.del")),1)):u("",!0)])):u("",!0)])],64)):(i(),o("div",x,[B(a.$slots,"empty",{},()=>[r(l,{icon:"ep:plus"})],!0)]))]),_:3},8,["id","class","headers","drag","accept"]),c("div",T,[B(a.$slots,"tip",{},void 0,!0)]),d(_)?(i(),P(A,{key:0,onClose:t[2]||(t[2]=F=>_.value=!1),"url-list":[e.modelValue]},null,8,["url-list"])):u("",!0)])}}}),[["__scopeId","data-v-85027349"]])});export{C as _,de as __tla};
