import{d as H,aa as i,c6 as J,r as o,c4 as K,c5 as N,au as Q,o as T,c as R,f as c,w as U,a as p,i as X,n as Y,e as r,aE as $,l as Z,V as aa,bP as m,aW as ea,b6 as la,_ as ta,a6 as sa,a7 as ia,__tla as ra}from"./index-c0a26e5e.js";import{E as ua,__tla as da}from"./el-image-viewer-5eb59d31.js";import{u as na,__tla as oa}from"./useUpload-2541f433.js";import{u as ca,__tla as pa}from"./useMessage-3978ad3b.js";let j,ma=Promise.all([(()=>{try{return ra}catch{}})(),(()=>{try{return da}catch{}})(),(()=>{try{return oa}catch{}})(),(()=>{try{return pa}catch{}})()]).then(async()=>{let f,v,y,h,b,k,w,x,z;f=l=>(sa("data-v-38f2dc38"),l=l(),ia(),l),v={class:"upload-box"},y={class:"upload-empty"},h=["src"],b=["onClick"],k=f(()=>r("span",null,"\u67E5\u770B",-1)),w=["onClick"],x=f(()=>r("span",null,"\u5220\u9664",-1)),z={class:"el-upload__tip"},j=H({name:"UploadImgs",__name:"UploadImgs",props:{modelValue:{type:Array,required:!0},drag:i.bool.def(!0),disabled:i.bool.def(!1),limit:i.number.def(12),fileSize:i.number.def(30),fileType:i.array.def(["image/jpeg","image/png","image/gif"]),height:i.string.def("150px"),width:i.string.def("150px"),borderradius:i.string.def("8px"),bucket:i.string.def("product")},emits:["update:modelValue"],setup(l,{emit:q}){J(a=>({"5a72e989":l.borderradius,c5c81b4a:l.width,"26d9419c":l.height}));const C=ca(),{signatureUrl:A,put:E,getStsToken:I}=na(),u=l,M=o({Authorization:"Bearer "+K(),"tenant-id":N()}),t=o([]);Q(()=>u.modelValue,a=>{a&&(t.value=a)},{deep:!0,immediate:!0});const P=a=>{const e=a.size/1024/1024<u.fileSize,s=u.fileType;return s.includes(a.type)||m({title:"\u6E29\u99A8\u63D0\u793A",message:"\u4E0A\u4F20\u56FE\u7247\u4E0D\u7B26\u5408\u6240\u9700\u7684\u683C\u5F0F\uFF01",type:"warning"}),e||m({title:"\u6E29\u99A8\u63D0\u793A",message:`\u4E0A\u4F20\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 ${u.fileSize}M\uFF01`,type:"warning"}),s.includes(a.type)&&e},g=q,B=(a,e)=>{a&&(e.url=a.data,g("update:modelValue",t.value),C.success("\u4E0A\u4F20\u6210\u529F"))},L=()=>{m({title:"\u6E29\u99A8\u63D0\u793A",message:"\u56FE\u7247\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u60A8\u91CD\u65B0\u4E0A\u4F20\uFF01",type:"error"})},O=()=>{m({title:"\u6E29\u99A8\u63D0\u793A",message:`\u5F53\u524D\u6700\u591A\u53EA\u80FD\u4E0A\u4F20 ${u.limit} \u5F20\u56FE\u7247\uFF0C\u8BF7\u79FB\u9664\u540E\u4E0A\u4F20\uFF01`,type:"warning"})},W=async a=>{await I(u.bucket);const{name:e}=a.file;await E(e,a.file);let s=await A(e);s=s.substring(0,s.indexOf("?")),t.value[t.value.length-1].url=s,g("update:modelValue",t.value),C.success("\u4E0A\u4F20\u6210\u529F")},V=o(""),_=o(!1);return(a,e)=>{const s=ta,D=ea,F=ua;return T(),R("div",v,[c(D,{"file-list":p(t),"onUpdate:fileList":e[1]||(e[1]=d=>X(t)?t.value=d:null),accept:l.fileType.join(","),"http-request":W,"before-upload":P,class:Y(["upload",l.drag?"no-border":""]),drag:l.drag,headers:p(M),limit:l.limit,multiple:!0,"on-error":L,"on-exceed":O,"on-success":B,"list-type":"picture-card"},{file:U(({file:d})=>[r("img",{src:d.url,class:"upload-image"},null,8,h),r("div",{class:"upload-handle",onClick:e[0]||(e[0]=la(()=>{},["stop"]))},[r("div",{class:"handle-icon",onClick:G=>{return n=d,V.value=n.url,void(_.value=!0);var n}},[c(s,{icon:"ep:zoom-in"}),k],8,b),r("div",{class:"handle-icon",onClick:G=>{return n=d,t.value=t.value.filter(S=>S.url!==n.url||S.name!==n.name),void g("update:modelValue",t.value);var n}},[c(s,{icon:"ep:delete"}),x],8,w)])]),default:U(()=>[r("div",y,[$(a.$slots,"empty",{},()=>[c(s,{icon:"ep:plus"})],!0)])]),_:3},8,["file-list","accept","class","drag","headers","limit"]),r("div",z,[$(a.$slots,"tip",{},void 0,!0)]),p(_)?(T(),Z(F,{key:0,"url-list":[p(V)],onClose:e[2]||(e[2]=d=>_.value=!1)},null,8,["url-list"])):aa("",!0)])}}})});export{j as _,ma as __tla};
