import{al as u,d as x,r as v,G as j,j as B,au as P,o as d,l as F,w as m,f as i,e as w,t as G,c as U,m as g,F as C,a as L,B as M,C as $,__tla as z}from"./index-c0a26e5e.js";import{_ as A,__tla as D}from"./XTextButton-68969bf2.js";import{S as k}from"./constants-03dd36f5.js";import{g as E,__tla as H}from"./profile-b010171c.js";import{u as J,__tla as K}from"./useMessage-3978ad3b.js";let b,O=Promise.all([(()=>{try{return z}catch{}})(),(()=>{try{return D}catch{}})(),(()=>{try{return H}catch{}})(),(()=>{try{return K}catch{}})()]).then(async()=>{let y,_;y=["src"],_={class:"mr-5"},b=x({name:"UserSocial",__name:"UserSocial",props:{activeName:{}},emits:["update:activeName"],setup(Q,{emit:R}){const f=J(),c=v([]),l=v(),h=async()=>{var t;c.value=[];const a=await E();l.value=a;for(const e in k){const s={...k[e]};if(c.value.push(s),(t=l.value)==null?void 0:t.socialUsers){for(const o in l.value.socialUsers)if(s.type===l.value.socialUsers[o].type){s.openid=l.value.socialUsers[o].openid;break}}}},n=j(),S=R,q=()=>{const a=(t="type",new URL(decodeURIComponent(location.href)).searchParams.get(t)??"");var t;const e=n.query.code,s=n.query.state;e&&((o,r,p)=>u.post({url:"/system/social-user/bind",data:{type:o,code:r,state:p}}))(a,e,s).then(()=>{f.success("\u7ED1\u5B9A\u6210\u529F"),S("update:activeName","userSocial"),h()})},I=a=>{const t=location.origin+"/user/profile?"+encodeURIComponent(`type=${a.type}`);((e,s)=>u.get({url:"/system/auth/social-auth-redirect?type="+e+"&redirectUri="+s}))(a.type,encodeURIComponent(t)).then(e=>{window.location.href=e})},N=async a=>{var t,e;await(t=a.type,e=a.openid,u.delete({url:"/system/social-user/unbind",data:{type:t,openid:e}}))&&(a.openid=void 0),f.success("\u89E3\u7ED1\u6210\u529F")};return B(async()=>{await h()}),P(()=>n,()=>{q()},{immediate:!0}),(a,t)=>{const e=M,s=A,o=$;return d(),F(o,{data:L(c),"show-header":!1},{default:m(()=>[i(e,{fixed:"left",title:"\u5E8F\u53F7",type:"seq",width:"60"}),i(e,{align:"left",label:"\u793E\u4EA4\u5E73\u53F0",width:"120"},{default:m(({row:r})=>[w("img",{src:r.img,alt:"",class:"h-5 align-middle"},null,8,y),w("p",_,G(r.title),1)]),_:1}),i(e,{align:"center",label:"\u64CD\u4F5C"},{default:m(({row:r})=>[r.openid?(d(),U(C,{key:0},[g(" \u5DF2\u7ED1\u5B9A "),i(s,{class:"mr-5",title:"(\u89E3\u7ED1)",type:"primary",onClick:p=>N(r)},null,8,["onClick"])],64)):(d(),U(C,{key:1},[g(" \u672A\u7ED1\u5B9A "),i(s,{class:"mr-5",title:"(\u7ED1\u5B9A)",type:"primary",onClick:p=>I(r)},null,8,["onClick"])],64))]),_:1})]),_:1},8,["data"])}}})});export{b as _,O as __tla};
