import{d as T,u as G,G as z,r as s,j as A,p as H,a as r,o as I,l as E,w as l,f as i,i as h,m as V,V as L,g as M,am as v,an as P,ao as Q,ap as k,E as W,h as X,z as Y,x as Z,A as $,D as q,__tla as K}from"./index-456ccb5c.js";import{_ as tt,__tla as at}from"./ContentWrap.vue_vue_type_script_setup_true_lang-9220e529.js";import{u as rt,__tla as et}from"./tagsView-64f828b2.js";import{g as _t,c as ct,u as ot,__tla as it}from"./spu-364c3f5b.js";import{_ as lt,__tla as st}from"./BasicInfoForm.vue_vue_type_script_setup_true_lang-ea9b995f.js";import{_ as mt,__tla as nt}from"./DescriptionForm.vue_vue_type_script_setup_true_lang-95c6856d.js";import{_ as ut,__tla as pt}from"./OtherSettingsForm.vue_vue_type_script_setup_true_lang-6032805b.js";import{_ as ft,__tla as dt}from"./ServiceInfoForm.vue_vue_type_script_setup_true_lang-7af9c76e.js";import{u as yt,__tla as ht}from"./useMessage-59021f66.js";import{__tla as vt}from"./el-card-efc77ac9.js";import{__tla as Pt}from"./Descriptions-ecddef8a.js";import{__tla as kt}from"./Descriptions.vue_vue_type_style_index_0_scoped_59d56eec_lang-8d00a5b9.js";import{__tla as gt}from"./el-descriptions-item-88ef9e14.js";import{__tla as Nt}from"./DictTag.vue_vue_type_script_lang-ebfeda4d.js";import"./color-a8b4eb58.js";import{__tla as Bt}from"./dict-000efb2b.js";import"./_plugin-vue_export-helper-1b428a4d.js";import{__tla as St}from"./el-image-af14a6b7.js";import{__tla as bt}from"./el-image-viewer-5ea9d668.js";import{__tla as wt}from"./UploadImgs-f366bb9f.js";import{__tla as Dt}from"./UploadImgs.vue_vue_type_style_index_0_scoped_38f2dc38_lang-50a5f5ba.js";import{__tla as Ut}from"./useUpload-cc5bd1be.js";import{__tla as Ft}from"./aliyun-oss-sdk-a3e481f3.js";import"./_commonjs-dynamic-modules-3e972b61.js";import{__tla as It}from"./UploadImg-42841f7d.js";import"./tree-ebab458e.js";import{__tla as Et}from"./index-0a7e975b.js";import{__tla as Vt}from"./ImageViewer.vue_vue_type_script_setup_true_lang-82d6ea37.js";import{__tla as Ct}from"./index-15d920e1.js";import{__tla as Ot}from"./SkuList.vue_vue_type_script_setup_true_lang-9c6179aa.js";import{__tla as Rt}from"./UploadFile.vue_vue_type_style_index_0_scoped_113ae07d_lang-3dab4672.js";import{__tla as jt}from"./ProductAttributes.vue_vue_type_script_setup_true_lang-e3d45a3c.js";import{__tla as Jt}from"./el-text-8dddc33f.js";import{__tla as xt}from"./property-efc873b2.js";import{__tla as Tt}from"./ProductPropertyAddForm.vue_vue_type_script_setup_true_lang-39d00c86.js";import{__tla as Gt}from"./Dialog.vue_vue_type_style_index_0_lang-c9eb9937.js";import{__tla as zt}from"./spu.data-ba187dce.js";import{__tla as At}from"./category-69cd96e4.js";import{__tla as Ht}from"./brand-7b23104f.js";import{__tla as Lt}from"./useCrudSchemas-e7c2c8da.js";import{__tla as Mt}from"./formRules-8bcd5a91.js";import{__tla as Qt}from"./ActivityOrdersSort.vue_vue_type_script_setup_true_lang-7a007a9f.js";let C,Wt=Promise.all([(()=>{try{return K}catch{}})(),(()=>{try{return at}catch{}})(),(()=>{try{return et}catch{}})(),(()=>{try{return it}catch{}})(),(()=>{try{return st}catch{}})(),(()=>{try{return nt}catch{}})(),(()=>{try{return pt}catch{}})(),(()=>{try{return dt}catch{}})(),(()=>{try{return ht}catch{}})(),(()=>{try{return vt}catch{}})(),(()=>{try{return Pt}catch{}})(),(()=>{try{return kt}catch{}})(),(()=>{try{return gt}catch{}})(),(()=>{try{return Nt}catch{}})(),(()=>{try{return Bt}catch{}})(),(()=>{try{return St}catch{}})(),(()=>{try{return bt}catch{}})(),(()=>{try{return wt}catch{}})(),(()=>{try{return Dt}catch{}})(),(()=>{try{return Ut}catch{}})(),(()=>{try{return Ft}catch{}})(),(()=>{try{return It}catch{}})(),(()=>{try{return Et}catch{}})(),(()=>{try{return Vt}catch{}})(),(()=>{try{return Ct}catch{}})(),(()=>{try{return Ot}catch{}})(),(()=>{try{return Rt}catch{}})(),(()=>{try{return jt}catch{}})(),(()=>{try{return Jt}catch{}})(),(()=>{try{return xt}catch{}})(),(()=>{try{return Tt}catch{}})(),(()=>{try{return Gt}catch{}})(),(()=>{try{return zt}catch{}})(),(()=>{try{return At}catch{}})(),(()=>{try{return Ht}catch{}})(),(()=>{try{return Lt}catch{}})(),(()=>{try{return Mt}catch{}})(),(()=>{try{return Qt}catch{}})()]).then(async()=>{C=T({name:"ProductSpuForm",__name:"index",setup(Xt){const{t:N}=M(),B=yt(),{push:O,currentRoute:R}=G(),{params:S,name:j}=z(),{delView:J}=rt(),n=s(!1),c=s("basicInfo"),m=s(!1),b=s(),w=s(),D=s(),U=s(),u=s({name:"",categoryId:void 0,keyword:"",unit:void 0,picUrl:"",sliderPicUrls:"",introduction:"",deliveryTemplateId:void 0,brandId:void 0,specType:!1,subCommissionType:!1,skus:[{price:0,marketPrice:0,costPrice:0,barCode:"",picUrl:"",stock:0,weight:0,volume:0,firstBrokeragePrice:0,secondBrokeragePrice:0}],description:"",service:"",sort:0,giveIntegral:0,virtualSalesCount:0,recommendHot:!1,recommendBenefit:!1,recommendBest:!1,recommendNew:!1,recommendGood:!1,activityOrders:[]}),x=async()=>{var p,e,_,a;n.value=!0;try{await((p=r(b))==null?void 0:p.validate()),await((e=r(w))==null?void 0:e.validate()),await((_=r(D))==null?void 0:_.validate()),await((a=r(U))==null?void 0:a.validate());const o=Q(r(u.value));o.skus.forEach(t=>{t.name=o.name,t.price=k(t.price),t.marketPrice=k(t.marketPrice),t.costPrice=k(t.costPrice),t.firstBrokeragePrice=k(t.firstBrokeragePrice),t.secondBrokeragePrice=k(t.secondBrokeragePrice)});const f=[];o.sliderPicUrls.forEach(t=>{typeof t=="object"?f.push(t.url):f.push(t)}),o.sliderPicUrls=f;const d=[];o.description.forEach(t=>{typeof t=="object"?d.push(t.url):d.push(t)});const y=[];o.service.forEach(t=>{typeof t=="object"?y.push(t.url):y.push(t)}),o.description=JSON.stringify(d),o.service=JSON.stringify(y);let g=o;S.id?(await ot(g),B.success(N("common.updateSuccess"))):(await ct(g),B.success(N("common.createSuccess"))),F()}finally{n.value=!1}},F=()=>{J(r(R)),O({name:"ProductSpu"})};return A(async()=>{await(async()=>{var e;j==="ProductSpuDetail"&&(m.value=!0);const p=S.id;if(p){n.value=!0;try{const _=await _t(p);try{_.description=JSON.parse(_.description),_.service=JSON.parse(_.service)}catch{_.description=[],_.service=[]}(e=_.skus)==null||e.forEach(a=>{m.value?(a.price=v(a.price),a.marketPrice=v(a.marketPrice),a.costPrice=v(a.costPrice),a.firstBrokeragePrice=v(a.firstBrokeragePrice),a.secondBrokeragePrice=v(a.secondBrokeragePrice)):(a.price=P(a.price),a.marketPrice=P(a.marketPrice),a.costPrice=P(a.costPrice),a.firstBrokeragePrice=P(a.firstBrokeragePrice),a.secondBrokeragePrice=P(a.secondBrokeragePrice))}),u.value=_}finally{n.value=!1}}})()}),(p,e)=>{const _=W,a=X,o=Y,f=Z,d=$,y=tt,g=q;return H((I(),E(y,null,{default:l(()=>[i(a,{modelValue:r(c),"onUpdate:modelValue":e[4]||(e[4]=t=>h(c)?c.value=t:null)},{default:l(()=>[i(_,{label:"\u5546\u54C1\u4FE1\u606F",name:"basicInfo"},{default:l(()=>[i(lt,{ref_key:"basicInfoRef",ref:b,activeName:r(c),"onUpdate:activeName":e[0]||(e[0]=t=>h(c)?c.value=t:null),"is-detail":r(m),propFormData:r(u)},null,8,["activeName","is-detail","propFormData"])]),_:1}),i(_,{label:"\u5546\u54C1\u8BE6\u60C5",name:"description"},{default:l(()=>[i(mt,{ref_key:"descriptionRef",ref:w,activeName:r(c),"onUpdate:activeName":e[1]||(e[1]=t=>h(c)?c.value=t:null),"is-detail":r(m),propFormData:r(u)},null,8,["activeName","is-detail","propFormData"])]),_:1}),i(_,{label:"\u5176\u4ED6\u8BBE\u7F6E",name:"otherSettings"},{default:l(()=>[i(ut,{ref_key:"otherSettingsRef",ref:D,activeName:r(c),"onUpdate:activeName":e[2]||(e[2]=t=>h(c)?c.value=t:null),"is-detail":r(m),propFormData:r(u)},null,8,["activeName","is-detail","propFormData"])]),_:1}),i(_,{label:"\u670D\u52A1\u8BF4\u660E",name:"ServiceInfo"},{default:l(()=>[i(ft,{ref_key:"ServiceInfoRef",ref:U,activeName:r(c),"onUpdate:activeName":e[3]||(e[3]=t=>h(c)?c.value=t:null),"is-detail":r(m),propFormData:r(u)},null,8,["activeName","is-detail","propFormData"])]),_:1})]),_:1},8,["modelValue"]),i(d,null,{default:l(()=>[i(f,{style:{float:"right"}},{default:l(()=>[r(m)?L("",!0):(I(),E(o,{key:0,loading:r(n),type:"primary",onClick:x},{default:l(()=>[V(" \u4FDD\u5B58 ")]),_:1},8,["loading"])),i(o,{onClick:F},{default:l(()=>[V("\u8FD4\u56DE")]),_:1})]),_:1})]),_:1})]),_:1})),[[g,r(n)]])}}})});export{Wt as __tla,C as default};
